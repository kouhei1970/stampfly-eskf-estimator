# Outdoor Flight Parameters for StampFly
# Optimized for outdoor environments with GPS and magnetometer

estimator:
  type: "ESKF"

  process_noise:
    sigma_a: 0.1        # Lower - less environmental disturbance
    sigma_omega: 0.001  # Lower - more stable conditions
    sigma_bg: 0.00005
    sigma_ba: 0.001     # Lower for outdoor

  initial_covariance:
    sigma_p: 2.0        # Larger initial uncertainty without indoor references
    sigma_v: 0.5
    sigma_theta: 0.15
    sigma_bg: 0.01
    sigma_ba: 0.1

sensors:
  imu:
    rate_hz: 200
    accelerometer:
      noise_density: 0.1
      bias_stability: 0.001
    gyroscope:
      noise_density: 0.001
      bias_stability: 0.00005

  # Magnetometer is reliable outdoors
  magnetometer:
    enabled: true
    rate_hz: 50
    noise_std: 0.3  # Good magnetic environment
    declination_deg: 7.0  # Adjust for your location

  barometer:
    enabled: true
    rate_hz: 20
    noise_std: 0.5  # More reliable outdoors

  # ToF less critical outdoors (higher altitudes)
  tof:
    enabled: true
    rate_hz: 50
    noise_std: 0.1
    max_range: 4.0
    tilt_compensation: true

  # Optical flow less reliable outdoors (varying terrain)
  optical_flow:
    enabled: false  # Typically disabled for outdoor flight
    rate_hz: 0
    noise_std: 2.0  # Higher uncertainty on natural terrain
    min_altitude: 0.2
    max_altitude: 5.0

  # GPS (for future implementation)
  gps:
    enabled: false  # Not yet implemented
    rate_hz: 10
    horizontal_accuracy: 2.0  # meters
    vertical_accuracy: 3.0

constants:
  gravity: 9.81

outlier_rejection:
  enabled: true
  mahalanobis_threshold: 9.21  # 99% for 2-DOF (less strict outdoors)

coordinate_system: "NED"

# Outdoor-specific settings
outdoor_mode:
  use_gps_for_position: false  # Future feature
  use_magnetometer_for_heading: true
  trust_barometer_over_tof: true
  enable_wind_estimation: false  # Future feature
